#region Imports

using System;
using System.Drawing;
using System.Windows.Forms;
using System.Drawing.Drawing2D;
using System.ComponentModel;
using System.Drawing.Text;
using System.Globalization;
using Microsoft.VisualBasic;
using System.Collections.Generic;
using Microsoft.VisualBasic.CompilerServices;
using static Helpers;

#endregion

enum MouseState : byte
{
    None = 0,
    Over = 1,
    Down = 2,
    Block = 3
}
internal sealed class Helpers
{
    public enum RoundingStyle : byte
    {
        All,
        Top,
        Bottom,
        Left,
        Right,
        TopRight,
        BottomRight
    }

    public void CenterString(Graphics G, string T, Font F, Color C, Rectangle R)
    {
        SizeF sizeF = G.MeasureString(T, F);
        using (SolidBrush B = new SolidBrush(C))
        {
            G.DrawString(T, F, B, checked(new Point((int)Math.Round(unchecked((double)R.Width / 2.0 - (double)(sizeF.Width / 2f))), (int)Math.Round(unchecked((double)R.Height / 2.0 - (double)(sizeF.Height / 2f))))));
        }
    }

    public static Color FromHex(string hex)
    {
        return ColorTranslator.FromHtml(hex);
    }



    public static Color ColorFromHex(string Hex)
    {
        return Color.FromArgb(checked((int)long.Parse(string.Format("FFFFFFFFFF{0}", Hex.Substring(1)), NumberStyles.HexNumber)));
    }


    public static Rectangle FullRectangle(Size S, bool Subtract)
    {
        Rectangle result;
        if (Subtract)
        {
            result = checked(new Rectangle(0, 0, S.Width - 1, S.Height - 1));
        }
        else
        {
            result = new Rectangle(0, 0, S.Width, S.Height);
        }
        return result;
    }

    public static GraphicsPath RoundRect(Rectangle Rect, int Rounding, Helpers.RoundingStyle Style = Helpers.RoundingStyle.All)
    {
        GraphicsPath graphicsPath = new GraphicsPath();
        checked
        {
            int num = Rounding * 2;
            graphicsPath.StartFigure();
            bool flag = Rounding == 0;
            GraphicsPath result;
            if (flag)
            {
                graphicsPath.AddRectangle(Rect);
                graphicsPath.CloseAllFigures();
                result = graphicsPath;
            }
            else
            {
                switch (Style)
                {
                    case Helpers.RoundingStyle.All:
                        graphicsPath.AddArc(new Rectangle(Rect.X, Rect.Y, num, num), -180f, 90f);
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Y, num, num), -90f, 90f);
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Height - num + Rect.Y, num, num), 0f, 90f);
                        graphicsPath.AddArc(new Rectangle(Rect.X, Rect.Height - num + Rect.Y, num, num), 90f, 90f);
                        break;
                    case Helpers.RoundingStyle.Top:
                        graphicsPath.AddArc(new Rectangle(Rect.X, Rect.Y, num, num), -180f, 90f);
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Y, num, num), -90f, 90f);
                        graphicsPath.AddLine(new Point(Rect.X + Rect.Width, Rect.Y + Rect.Height), new Point(Rect.X, Rect.Y + Rect.Height));
                        break;
                    case Helpers.RoundingStyle.Bottom:
                        graphicsPath.AddLine(new Point(Rect.X, Rect.Y), new Point(Rect.X + Rect.Width, Rect.Y));
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Height - num + Rect.Y, num, num), 0f, 90f);
                        graphicsPath.AddArc(new Rectangle(Rect.X, Rect.Height - num + Rect.Y, num, num), 90f, 90f);
                        break;
                    case Helpers.RoundingStyle.Left:
                        graphicsPath.AddArc(new Rectangle(Rect.X, Rect.Y, num, num), -180f, 90f);
                        graphicsPath.AddLine(new Point(Rect.X + Rect.Width, Rect.Y), new Point(Rect.X + Rect.Width, Rect.Y + Rect.Height));
                        graphicsPath.AddArc(new Rectangle(Rect.X, Rect.Height - num + Rect.Y, num, num), 90f, 90f);
                        break;
                    case Helpers.RoundingStyle.Right:
                        graphicsPath.AddLine(new Point(Rect.X, Rect.Y + Rect.Height), new Point(Rect.X, Rect.Y));
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Y, num, num), -90f, 90f);
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Height - num + Rect.Y, num, num), 0f, 90f);
                        break;
                    case Helpers.RoundingStyle.TopRight:
                        graphicsPath.AddLine(new Point(Rect.X, Rect.Y + 1), new Point(Rect.X, Rect.Y));
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Y, num, num), -90f, 90f);
                        graphicsPath.AddLine(new Point(Rect.X + Rect.Width, Rect.Y + Rect.Height - 1), new Point(Rect.X + Rect.Width, Rect.Y + Rect.Height));
                        graphicsPath.AddLine(new Point(Rect.X + 1, Rect.Y + Rect.Height), new Point(Rect.X, Rect.Y + Rect.Height));
                        break;
                    case Helpers.RoundingStyle.BottomRight:
                        graphicsPath.AddLine(new Point(Rect.X, Rect.Y + 1), new Point(Rect.X, Rect.Y));
                        graphicsPath.AddLine(new Point(Rect.X + Rect.Width - 1, Rect.Y), new Point(Rect.X + Rect.Width, Rect.Y));
                        graphicsPath.AddArc(new Rectangle(Rect.Width - num + Rect.X, Rect.Height - num + Rect.Y, num, num), 0f, 90f);
                        graphicsPath.AddLine(new Point(Rect.X + 1, Rect.Y + Rect.Height), new Point(Rect.X, Rect.Y + Rect.Height));
                        break;
                }
                graphicsPath.CloseAllFigures();
                result = graphicsPath;
            }
            return result;
        }
    }



}




namespace VelyseTheme
{
    #region  RoundRectangle

    sealed class RoundRectangle
    {
        public static GraphicsPath RoundRect(Rectangle Rectangle, int Curve)
        {
            GraphicsPath P = new GraphicsPath();
            int ArcRectangleWidth = Curve * 2;
            P.AddArc(new Rectangle(Rectangle.X, Rectangle.Y, ArcRectangleWidth, ArcRectangleWidth), -180, 90);
            P.AddArc(new Rectangle(Rectangle.Width - ArcRectangleWidth + Rectangle.X, Rectangle.Y, ArcRectangleWidth, ArcRectangleWidth), -90, 90);
            P.AddArc(new Rectangle(Rectangle.Width - ArcRectangleWidth + Rectangle.X, Rectangle.Height - ArcRectangleWidth + Rectangle.Y, ArcRectangleWidth, ArcRectangleWidth), 0, 90);
            P.AddArc(new Rectangle(Rectangle.X, Rectangle.Height - ArcRectangleWidth + Rectangle.Y, ArcRectangleWidth, ArcRectangleWidth), 90, 90);
            P.AddLine(new Point(Rectangle.X, Rectangle.Height - ArcRectangleWidth + Rectangle.Y), new Point(Rectangle.X, Curve + Rectangle.Y));
            return P;
        }
    }

    #endregion

    #region  ThemeContainer

    public class VelyseForm : ContainerControl
    {

        #region  Enums

        public enum MouseState
        {
            None = 0,
            Over = 1,
            Down = 2,
            Block = 3
        }

        #endregion
        #region  Variables

        private Rectangle HeaderRect;
        protected MouseState State;
        private int MoveHeight;
        private Point MouseP = new Point(0, 0);
        private bool Cap = false;
        private bool HasShown;

        #endregion
        #region  Properties

        private bool _Sizable = true;
        public bool Sizable
        {
            get
            {
                return _Sizable;
            }
            set
            {
                _Sizable = value;
            }
        }

        private bool _SmartBounds = true;
        public bool SmartBounds
        {
            get
            {
                return _SmartBounds;
            }
            set
            {
                _SmartBounds = value;
            }
        }

        public enum VLRoundCorner
        {
            Round,
            Square,

        }
        VLRoundCorner _RoundCorner = new VLRoundCorner();
        public VLRoundCorner RoundCorners
        {
            get { return _RoundCorner; }
            set { _RoundCorner = value; }
        }





        private bool _IsParentForm;
        protected bool IsParentForm
        {
            get
            {
                return _IsParentForm;
            }
        }

        protected bool IsParentMdi
        {
            get
            {
                if (Parent == null)
                {
                    return false;
                }
                return Parent.Parent != null;
            }
        }

        private bool _ControlMode;
        protected bool ControlMode
        {
            get
            {
                return _ControlMode;
            }
            set
            {
                _ControlMode = value;
                Invalidate();
            }
        }

        private FormStartPosition _StartPosition;
        public FormStartPosition StartPosition
        {
            get
            {
                if (_IsParentForm && !_ControlMode)
                {
                    return ParentForm.StartPosition;
                }
                else
                {
                    return _StartPosition;
                }
            }
            set
            {
                _StartPosition = value;

                if (_IsParentForm && !_ControlMode)
                {
                    ParentForm.StartPosition = value;
                }
            }
        }

        private Color _TopColor = Color.FromArgb(49, 79, 124);
        [Category("Velyse Appearance")]
        public Color TopColor
        {
            get { return _TopColor; }
            set { _TopColor = value; }
        }

        private Color _BackColor = Color.FromArgb(30, 33, 35);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        private Color _TextColor = Color.White;
        [Category("Velyse Appearance")]
        public Color TextColor
        {
            get { return _TextColor; }
            set { _TextColor = value; }
        }

        private Font _Font = new Font("Segoe UI", 12);
        [Category("Velyse Appearance")]
        public Font Text_Font
        {
            get { return _Font; }
            set { _Font = value; }
        }


        #endregion
        #region  EventArgs


        protected sealed override void OnParentChanged(EventArgs e)
        {
            base.OnParentChanged(e);

            if (Parent == null)
            {
                return;
            }
            _IsParentForm = Parent is Form;

            if (!_ControlMode)
            {
                InitializeMessages();

                if (_IsParentForm)
                {
                    this.ParentForm.FormBorderStyle = FormBorderStyle.None;
                    this.ParentForm.TransparencyKey = Color.Fuchsia;

                    if (!DesignMode)
                    {
                        ParentForm.Shown += FormShown;
                    }
                }
                Parent.BackColor = BackColor;
                //   Parent.MinimumSize = New Size(261, 65)
            }
        }

        protected sealed override void OnSizeChanged(EventArgs e)
        {
            base.OnSizeChanged(e);
            if (!_ControlMode)
            {
                HeaderRect = new Rectangle(0, 0, Width - 14, MoveHeight - 7);
            }
            Invalidate();
        }

        protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            Focus();
            if (e.Button == MouseButtons.Left)
            {
                SetState(MouseState.Down);
            }
            if (!(_IsParentForm && ParentForm.WindowState == FormWindowState.Maximized || _ControlMode))
            {
                if (HeaderRect.Contains(e.Location))
                {
                    Capture = false;
                    WM_LMBUTTONDOWN = true;
                    DefWndProc(ref Messages[0]);
                }
                else if (_Sizable && !(Previous == 0))
                {
                    Capture = false;
                    WM_LMBUTTONDOWN = true;
                    DefWndProc(ref Messages[Previous]);
                }
            }
        }

        protected override void OnMouseUp(MouseEventArgs e)
        {
            base.OnMouseUp(e);
            Cap = false;
        }

        protected override void OnMouseMove(MouseEventArgs e)
        {
            base.OnMouseMove(e);
            if (!(_IsParentForm && ParentForm.WindowState == FormWindowState.Maximized))
            {
                if (_Sizable && !_ControlMode)
                {
                    InvalidateMouse();
                }
            }
            if (Cap)
            {
                Parent.Location = (Point)((object)(Convert.ToDouble(MousePosition) - Convert.ToDouble(MouseP)));
            }
        }

        protected override void OnInvalidated(InvalidateEventArgs e)
        {
            base.OnInvalidated(e);
            ParentForm.Text = Text;
        }

        protected override void OnPaintBackground(PaintEventArgs e)
        {
            base.OnPaintBackground(e);
        }

        protected override void OnTextChanged(EventArgs e)
        {
            base.OnTextChanged(e);
            Invalidate();
        }

        private void FormShown(object sender, EventArgs e)
        {
            if (_ControlMode || HasShown)
            {
                return;
            }

            if (_StartPosition == FormStartPosition.CenterParent || _StartPosition == FormStartPosition.CenterScreen)
            {
                Rectangle SB = Screen.PrimaryScreen.Bounds;
                Rectangle CB = ParentForm.Bounds;
                ParentForm.Location = new Point(SB.Width / 2 - CB.Width / 2, SB.Height / 2 - CB.Width / 2);
            }
            HasShown = true;
        }

        #endregion
        #region  Mouse & Size

        private void SetState(MouseState current)
        {
            State = current;
            Invalidate();
        }

        private Point GetIndexPoint;
        private bool B1x;
        private bool B2x;
        private bool B3;
        private bool B4;
        private int GetIndex()
        {
            GetIndexPoint = PointToClient(MousePosition);
            B1x = GetIndexPoint.X < 7;
            B2x = GetIndexPoint.X > Width - 7;
            B3 = GetIndexPoint.Y < 7;
            B4 = GetIndexPoint.Y > Height - 7;

            if (B1x && B3)
            {
                return 4;
            }
            if (B1x && B4)
            {
                return 7;
            }
            if (B2x && B3)
            {
                return 5;
            }
            if (B2x && B4)
            {
                return 8;
            }
            if (B1x)
            {
                return 1;
            }
            if (B2x)
            {
                return 2;
            }
            if (B3)
            {
                return 3;
            }
            if (B4)
            {
                return 6;
            }
            return 0;
        }

        private int Current;
        private int Previous;
        private void InvalidateMouse()
        {
            Current = GetIndex();
            if (Current == Previous)
            {
                return;
            }

            Previous = Current;
            switch (Previous)
            {
                case 0:
                    Cursor = Cursors.Default;
                    break;
                case 6:
                    Cursor = Cursors.SizeNS;
                    break;
                case 8:
                    Cursor = Cursors.SizeNWSE;
                    break;
                case 7:
                    Cursor = Cursors.SizeNESW;
                    break;
            }
        }

        private Message[] Messages = new Message[9];
        private void InitializeMessages()
        {
            Messages[0] = Message.Create(Parent.Handle, 161, new IntPtr(2), IntPtr.Zero);
            for (int I = 1; I <= 8; I++)
            {
                Messages[I] = Message.Create(Parent.Handle, 161, new IntPtr(I + 9), IntPtr.Zero);
            }
        }

        private void CorrectBounds(Rectangle bounds)
        {
            if (Parent.Width > bounds.Width)
            {
                Parent.Width = bounds.Width;
            }
            if (Parent.Height > bounds.Height)
            {
                Parent.Height = bounds.Height;
            }

            int X = Parent.Location.X;
            int Y = Parent.Location.Y;

            if (X < bounds.X)
            {
                X = bounds.X;
            }
            if (Y < bounds.Y)
            {
                Y = bounds.Y;
            }

            int Width = bounds.X + bounds.Width;
            int Height = bounds.Y + bounds.Height;

            if (X + Parent.Width > Width)
            {
                X = Width - Parent.Width;
            }
            if (Y + Parent.Height > Height)
            {
                Y = Height - Parent.Height;
            }

            Parent.Location = new Point(X, Y);
        }

        private bool WM_LMBUTTONDOWN;
        protected override void WndProc(ref Message m)
        {
            base.WndProc(ref m);

            if (WM_LMBUTTONDOWN && m.Msg == 513)
            {
                WM_LMBUTTONDOWN = false;

                SetState(MouseState.Over);
                if (!_SmartBounds)
                {
                    return;
                }

                if (IsParentMdi)
                {
                    CorrectBounds(new Rectangle(Point.Empty, Parent.Parent.Size));
                }
                else
                {
                    CorrectBounds(Screen.FromControl(Parent).WorkingArea);
                }
            }
        }

        #endregion

        protected override void CreateHandle()
        {
            base.CreateHandle();
        }

        public VelyseForm()
        {
            SetStyle((ControlStyles)(139270), true);
            BackColor = _BackColor;
            Padding = new Padding(10, 70, 10, 9);
            DoubleBuffered = true;
            Dock = DockStyle.Fill;
            MoveHeight = 66;
            Font = _Font;
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            Graphics G = e.Graphics;

            G.Clear(_BackColor);
            G.FillRectangle(new SolidBrush(_TopColor), new Rectangle(0, 0, Width, 60));

            if (_RoundCorner == VLRoundCorner.Round)
            {
                // Draw Left upper corner
                G.FillRectangle(Brushes.Fuchsia, 0, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 1, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 2, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 3, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 0, 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 0, 2, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 0, 3, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 1, 1, 1, 1);

                G.FillRectangle(new SolidBrush(_TopColor), 1, 3, 1, 1);
                G.FillRectangle(new SolidBrush(_TopColor), 1, 2, 1, 1);
                G.FillRectangle(new SolidBrush(_TopColor), 2, 1, 1, 1);
                G.FillRectangle(new SolidBrush(_TopColor), 3, 1, 1, 1);

                // Draw right upper corner
                G.FillRectangle(Brushes.Fuchsia, Width - 1, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 2, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 3, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 4, 0, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, 2, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, 3, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 2, 1, 1, 1);

                G.FillRectangle(new SolidBrush(_TopColor), Width - 1, 3, 1, 1);
                G.FillRectangle(new SolidBrush(_TopColor), Width - 1, 2, 1, 1);
                G.FillRectangle(new SolidBrush(_TopColor), Width - 2, 1, 1, 1);
                G.FillRectangle(new SolidBrush(_TopColor), Width - 3, 1, 1, 1);

                // Draw Left bottom corner
                G.FillRectangle(Brushes.Fuchsia, 0, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 0, Height - 2, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 0, Height - 3, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 0, Height - 4, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 1, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 2, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 3, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 1, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, 1, Height - 2, 1, 1);

                G.FillRectangle(new SolidBrush(_BackColor), 1, Height - 3, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), 1, Height - 4, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), 3, Height - 2, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), 2, Height - 2, 1, 1);

                // Draw right bottom corner
                G.FillRectangle(Brushes.Fuchsia, Width - 1, Height, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 2, Height, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 3, Height, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 4, Height, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, Height - 2, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, Height - 3, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 2, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 3, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 4, Height - 1, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 1, Height - 4, 1, 1);
                G.FillRectangle(Brushes.Fuchsia, Width - 2, Height - 2, 1, 1);

                G.FillRectangle(new SolidBrush(_BackColor), Width - 2, Height - 3, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), Width - 2, Height - 4, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), Width - 4, Height - 2, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), Width - 3, Height - 2, 1, 1);
            }
            else if (_RoundCorner == VLRoundCorner.Square)
            {
                G.FillRectangle(new SolidBrush(_BackColor), Width - 2, Height - 3, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), Width - 2, Height - 4, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), Width - 4, Height - 2, 1, 1);
                G.FillRectangle(new SolidBrush(_BackColor), Width - 3, Height - 2, 1, 1);

            }


            G.DrawString(Text, _Font, new SolidBrush(_TextColor), new Rectangle(20, 20, Width - 1, Height), new StringFormat() { Alignment = StringAlignment.Near, LineAlignment = StringAlignment.Near });
        }
    }

    #endregion

    public class VelyseButton : Control
    {
        #region " Properties "

        private Color _MouseOver = Color.FromArgb(15, 132, 165);
        [Category("Velyse Appearance")]
        public Color MouseOver
        {
            get { return _MouseOver; }
            set { _MouseOver = value; }
        }

        private Color _MouseDown = Color.FromArgb(5, 122, 155);
        [Category("Velyse Appearance")]
        public Color VMouseDown
        {
            get { return _MouseDown; }
            set { _MouseDown = value; }
        }

        private Color _BackColor = Color.FromArgb(23, 26, 28);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        private Color _TextColor = Color.White;
        [Category("Velyse Appearance")]
        public Color TextColor
        {
            get { return _TextColor; }
            set { _TextColor = value; }
        }
        #endregion

        #region "Variables"
        #endregion
        private MouseState State = MouseState.None;

        #region "Properties"

        #region " Mouse States"

        protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            State = MouseState.Down;
            Invalidate();
        }
        protected override void OnMouseUp(MouseEventArgs e)
        {
            base.OnMouseUp(e);
            State = MouseState.Over;
            Invalidate();
        }
        protected override void OnMouseEnter(EventArgs e)
        {
            base.OnMouseEnter(e);
            State = MouseState.Over;
            Invalidate();
        }
        protected override void OnMouseLeave(EventArgs e)
        {
            base.OnMouseLeave(e);
            State = MouseState.None;
            Invalidate();
        }

        #endregion

        #endregion

        public VelyseButton()
        {
            Size = new Size(150, 50);
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            dynamic G = e.Graphics;
            // 23, 26, 28
            // 20, 23, 25

            G.Clear(_BackColor);
            G.DrawRectangle(new Pen(_BackColor), new Rectangle(0, 0, Width - 1, Height - 1));

            switch (State)
            {
                case MouseState.Over:
                    G.FillRectangle(new SolidBrush(_MouseOver), new Rectangle(1, 1, Width - 2, Height - 2));
                    break;
                case MouseState.Down:
                    G.FillRectangle(new SolidBrush(_MouseDown), new Rectangle(1, 1, Width - 2, Height - 2));
                    break;
            }

            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(0, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(0, 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(1, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(0, 2, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(2, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(1, 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 1, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 1, 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 2, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 1, 2, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 3, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 2, 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(0, Height - 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(0, Height - 2, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(1, Height - 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(0, Height - 3, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(2, Height - 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(1, Height - 2, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 1, Height - 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 1, Height - 2, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 2, Height - 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 1, Height - 3, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 3, Height - 1, 1, 1));
            G.FillRectangle(new SolidBrush(_BackColor), new Rectangle(Width - 2, Height - 2, 1, 1));

            G.DrawString(Text, Font, Brushes.White, new Point((Width / 2) - (TextRenderer.MeasureText(Text, Font).Width / 2), (Height / 2) - (TextRenderer.MeasureText(Text, Font).Height / 2)));

            base.OnPaint(e);


        }
    }

    #region  TextBox

    [DefaultEvent("TextChanged")]
    public class VelyseTextBox : Control
    {

        #region  Variables



        public TextBox VelyseTB = new TextBox();
        private int _maxchars = 32767;
        private bool _ReadOnly;
        private bool _Multiline;
        private Image _Image;
        private Size _ImageSize;
        private HorizontalAlignment ALNType;
        private bool isPasswordMasked = false;
        private Pen P1;
        private SolidBrush B1;
        private GraphicsPath Shape;

        #endregion
        #region  Properties



        public HorizontalAlignment TextAlignment
        {
            get
            {
                return ALNType;
            }
            set
            {
                ALNType = value;
                Invalidate();
            }
        }
        public int MaxLength
        {
            get
            {
                return _maxchars;
            }
            set
            {
                _maxchars = value;
                VelyseTB.MaxLength = MaxLength;
                Invalidate();
            }
        }

        public bool UseSystemPasswordChar
        {
            get
            {
                return isPasswordMasked;
            }
            set
            {
                VelyseTB.UseSystemPasswordChar = UseSystemPasswordChar;
                isPasswordMasked = value;
                Invalidate();
            }
        }
        public bool ReadOnly
        {
            get
            {
                return _ReadOnly;
            }
            set
            {
                _ReadOnly = value;
                if (VelyseTB != null)
                {
                    VelyseTB.ReadOnly = value;
                }
            }
        }
        public bool Multiline
        {
            get
            {
                return _Multiline;
            }
            set
            {
                _Multiline = value;
                if (VelyseTB != null)
                {
                    VelyseTB.Multiline = value;

                    if (value)
                    {
                        VelyseTB.Height = Height - 23;
                    }
                    else
                    {
                        Height = VelyseTB.Height + 23;
                    }
                }
            }
        }

        [Category("Velyse Appearance")]
        private Color _TextColor = Color.FromArgb(255, 255, 255);
        public Color TextColor
        {
            get { return _TextColor; }
            set { _TextColor = value; }
        }
        [Category("Velyse Appearance")]
        private Color _BaseColor = Color.FromArgb(21, 21, 21);

        public Color BaseColor
        {
            get { return _BaseColor; }
            set { _BaseColor = value; }
        }

        [Category("Velyse Appearance")]
        private Color _BorderColor = Color.FromArgb(49, 79, 124);
        public Color BorderColor
        {
            get { return _BorderColor; }
            set { _BorderColor = value; }
        }



        public Image Image
        {
            get
            {
                return _Image;
            }
            set
            {
                if (value == null)
                {
                    _ImageSize = Size.Empty;
                }
                else
                {
                    _ImageSize = value.Size;
                }

                _Image = value;

                if (Image == null)
                {
                    VelyseTB.Location = new Point(8, 10);
                }
                else
                {
                    VelyseTB.Location = new Point(35, 11);
                }
                Invalidate();
            }
        }

        protected Size ImageSize
        {
            get
            {
                return _ImageSize;
            }
        }



        #endregion

        #region  EventArgs


        private void _Enter(object Obj, EventArgs e)
        {
            P1 = new Pen(_BaseColor);
            Refresh();
        }

        private void _Leave(object Obj, EventArgs e)
        {
            P1 = new Pen(_BaseColor);
            Refresh();
        }

        private void OnBaseTextChanged(object s, EventArgs e)
        {
            Text = VelyseTB.Text;
        }

        protected override void OnTextChanged(EventArgs e)
        {
            base.OnTextChanged(e);
            VelyseTB.Text = Text;
            Invalidate();
        }

        protected override void OnForeColorChanged(EventArgs e)
        {
            base.OnForeColorChanged(e);
            VelyseTB.ForeColor = ForeColor;
            Invalidate();
        }

        protected override void OnFontChanged(EventArgs e)
        {
            base.OnFontChanged(e);
            VelyseTB.Font = Font;
        }

        protected override void OnPaintBackground(PaintEventArgs e)
        {
            base.OnPaintBackground(e);
        }

        private void _OnKeyDown(object Obj, KeyEventArgs e)
        {
            if (e.Control && e.KeyCode == Keys.A)
            {
                VelyseTB.SelectAll();
                e.SuppressKeyPress = true;
            }
            if (e.Control && e.KeyCode == Keys.C)
            {
                VelyseTB.Copy();
                e.SuppressKeyPress = true;
            }
        }

        protected override void OnResize(EventArgs e)
        {
            base.OnResize(e);
            if (_Multiline)
            {
                VelyseTB.Height = Height - 23;
            }
            else
            {
                Height = VelyseTB.Height + 23;
            }

            Shape = new GraphicsPath();
            Shape.AddArc(0, 0, 10, 10, 180, 90);
            Shape.AddArc(Width - 11, 0, 10, 10, -90, 90);
            Shape.AddArc(Width - 11, Height - 11, 10, 10, 0, 90);
            Shape.AddArc(0, Height - 11, 10, 10, 90, 90);
            Shape.CloseAllFigures();
        }

        protected override void OnGotFocus(EventArgs e)
        {
            base.OnGotFocus(e);
            VelyseTB.Focus();
        }

        public void _TextChanged(Object sender, EventArgs e)
        {
            Text = VelyseTB.Text;
        }

        public void _BaseTextChanged(Object sender, EventArgs e)
        {
            VelyseTB.Text = Text;
        }

        #endregion

        public void AddTextBox()
        {
            VelyseTB.Location = new Point(8, 10);
            VelyseTB.Text = String.Empty;
            VelyseTB.BorderStyle = BorderStyle.None;
            VelyseTB.TextAlign = HorizontalAlignment.Left;
            VelyseTB.Font = new Font("Tahoma", 11);
            VelyseTB.UseSystemPasswordChar = UseSystemPasswordChar;
            VelyseTB.Multiline = false;
            VelyseTB.BackColor = _BaseColor;
            VelyseTB.ScrollBars = ScrollBars.None;
            VelyseTB.KeyDown += _OnKeyDown;
            VelyseTB.Enter += _Enter;
            VelyseTB.Leave += _Leave;
            VelyseTB.TextChanged += OnBaseTextChanged;
        }

        public VelyseTextBox()
        {
            SetStyle(ControlStyles.SupportsTransparentBackColor, true);
            SetStyle(ControlStyles.UserPaint, true);

            AddTextBox();
            Controls.Add(VelyseTB);

            P1 = new Pen(_BaseColor);
            B1 = new SolidBrush(_BaseColor);
            BackColor = Color.Transparent;
            ForeColor = _TextColor;

            Text = null;
            Font = new Font("Segoe UI", 10);
            Size = new Size(97, 29);
            DoubleBuffered = true;
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            Bitmap B = new Bitmap(Width, Height);
            Graphics G = Graphics.FromImage(B);
            var W = Width - 1;
            var H = Height - 1;

            Rectangle Base = new Rectangle(0, 0, W, H);

            {
                var withBlock = G;
                withBlock.SmoothingMode = SmoothingMode.HighQuality;
                withBlock.PixelOffsetMode = PixelOffsetMode.HighQuality;
                withBlock.TextRenderingHint = TextRenderingHint.ClearTypeGridFit;
                withBlock.Clear(BackColor);

                //-- Colors
                VelyseTB.BackColor = _BaseColor;
                VelyseTB.ForeColor = _TextColor;

                //-- Base
                withBlock.FillRectangle(new SolidBrush(_BaseColor), Base);
            }
            base.OnPaint(e);
            G.Dispose();
            e.Graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
            e.Graphics.DrawImageUnscaled(B, 0, 0);
            B.Dispose();
        }
    }

    #endregion
    #region GroupBox
    class VelyseGroupBox : ContainerControl
    {

        #region " Properties "

        private Color _TopColor = Color.FromArgb(49, 79, 124);
        [Category("Velyse Appearance")]
        public Color TopColor
        {
            get { return _TopColor; }
            set { _TopColor = value; }
        }

        private Color _BackColor = Color.FromArgb(31, 31, 31);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        private Color _TextColor = Color.White;
        [Category("Velyse Appearance")]
        public Color TextColor
        {
            get { return _TextColor; }
            set { _TextColor = value; }
        }
        [Category("Velyse Appearance")]
        public enum PanelDr
        {
            Top,
            Side,

        }

        [Category("Velyse Appearance")]
        PanelDr _PanelSide = new PanelDr();
        public PanelDr PanelSide
        {
            get { return _PanelSide; }
            set { _PanelSide = value; }
        }

        private Font _Font = new Font("Arial", 9);
        [Category("Velyse Appearance")]
        public Font GroupBoxFont
        {
            get { return _Font; }
            set { _Font = value; }
        }
        #endregion

        public VelyseGroupBox()
        {
            Size = new Size(200, 100);
            BackColor = _BackColor;
        }
        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            dynamic G = e.Graphics;
            G.Clear(_BackColor);
            if (_PanelSide == PanelDr.Top)
            {

                G.FillRectangle(new SolidBrush(_TopColor), new Rectangle(0, 0, Width, 20));
                G.FillRectangle(new SolidBrush(_TopColor), new Rectangle(0, 0, Width, 20));

                G.DrawString(Text, _Font, new SolidBrush(_TextColor), new Point(10, 4));

            }
            else
            {

                G.FillRectangle(new SolidBrush(_TopColor), new Rectangle(0, 0, 7, Height));
                G.DrawString(Text, _Font, new SolidBrush(_TextColor), new Point(10, 4));

            }
        }
    }
    #endregion


    #region ControlBox

    class VelyseControlBox : Control
    {
        #region " Properties "
        private Color _BackColor = Color.FromArgb(49, 79, 124);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        private Color _HoverColor = Color.FromArgb(49, 79, 124);
        [Category("Velyse Appearance")]
        public Color HoverColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        //private Color _TextColor = Color.White;
        //[Category("Velyse Appearance")]
        //public Color TextColor
        //{
        //    get { return _TextColor; }
        //    set { _TextColor = value; }
        //}
        //private Color _OutLineColor = Color.FromArgb(35, 35, 35);
        //[Category("Velyse Appearance")]
        //public Color OutLineColor
        //{
        //    get { return _OutLineColor; }
        //    set { _OutLineColor = value; }
        //}
        #endregion
        #region Enums

        public enum ButtonHoverState
        {
            Minimize,
            Maximize,
            Close,
            None
        }

        #endregion
        #region Variables

        private ButtonHoverState ButtonHState = ButtonHoverState.None;

        #endregion
        #region Properties

        private bool _EnableMaximize = true;
        public bool EnableMaximizeButton
        {
            get { return _EnableMaximize; }
            set
            {
                _EnableMaximize = value;
                Invalidate();
            }
        }

        private bool _EnableMinimize = true;
        public bool EnableMinimizeButton
        {
            get { return _EnableMinimize; }
            set
            {
                _EnableMinimize = value;
                Invalidate();
            }
        }

        private bool _EnableHoverHighlight = false;
        public bool EnableHoverHighlight
        {
            get { return _EnableHoverHighlight; }
            set
            {
                _EnableHoverHighlight = value;
                Invalidate();
            }
        }

        #endregion
        #region EventArgs

        protected override void OnResize(EventArgs e)
        {
            base.OnResize(e);
            Size = new Size(100, 25);
        }

        protected override void OnMouseMove(MouseEventArgs e)
        {
            base.OnMouseMove(e);
            int X = e.Location.X;
            int Y = e.Location.Y;
            if (Y > 0 && Y < (Height - 2))
            {
                if (X > 0 && X < 34)
                {
                    ButtonHState = ButtonHoverState.Minimize;
                }
                else if (X > 33 && X < 65)
                {
                    ButtonHState = ButtonHoverState.Maximize;
                }
                else if (X > 64 && X < Width)
                {
                    ButtonHState = ButtonHoverState.Close;
                }
                else
                {
                    ButtonHState = ButtonHoverState.None;
                }
            }
            else
            {
                ButtonHState = ButtonHoverState.None;
            }
            Invalidate();
        }

        protected override void OnMouseUp(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            switch (ButtonHState)
            {
                case ButtonHoverState.Close:
                    Parent.FindForm().Close();
                    break;
                case ButtonHoverState.Minimize:
                    if (_EnableMinimize == true)
                    {
                        Parent.FindForm().WindowState = FormWindowState.Minimized;
                    }
                    break;
                case ButtonHoverState.Maximize:
                    if (_EnableMaximize == true)
                    {
                        if (Parent.FindForm().WindowState == FormWindowState.Normal)
                        {
                            Parent.FindForm().WindowState = FormWindowState.Maximized;
                        }
                        else
                        {
                            Parent.FindForm().WindowState = FormWindowState.Normal;
                        }
                    }
                    break;
            }
        }
        protected override void OnMouseLeave(EventArgs e)
        {
            base.OnMouseLeave(e);
            ButtonHState = ButtonHoverState.None;
            Invalidate();
        }

        protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            Focus();
        }

        #endregion

        public VelyseControlBox()
            : base()
        {
            DoubleBuffered = true;
            Anchor = AnchorStyles.Top | AnchorStyles.Right;
        }

        protected override void OnCreateControl()
        {
            base.OnCreateControl();
            try
            {
                int X = Location.X;
                Location = new Point(X, 0);
            }
            catch (Exception)
            {
            }
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            Graphics G = e.Graphics;
            G.Clear(_BackColor);

            if (_EnableHoverHighlight == true)
            {
                switch (ButtonHState)
                {
                    case ButtonHoverState.None:
                        G.Clear(_BackColor);
                        break;
                    case ButtonHoverState.Minimize:
                        if (_EnableMinimize == true)
                        {
                            G.FillRectangle(new SolidBrush(Color.FromArgb(156, 35, 35)), new Rectangle(3, 0, 30, Height));
                        }
                        break;
                    case ButtonHoverState.Maximize:
                        if (_EnableMaximize == true)
                        {
                            G.FillRectangle(new SolidBrush(Color.FromArgb(156, 35, 35)), new Rectangle(35, 0, 30, Height));
                        }
                        break;
                    case ButtonHoverState.Close:
                        G.FillRectangle(new SolidBrush(Color.FromArgb(156, 35, 35)), new Rectangle(66, 0, 35, Height));
                        break;
                }
            }

            //Close
            G.DrawString("r", new Font("Marlett", 12), new SolidBrush(Color.FromArgb(255, 254, 255)), new Point(Width - 16, 8), new StringFormat { Alignment = StringAlignment.Center });

            //Maximize
            switch (Parent.FindForm().WindowState)
            {
                case FormWindowState.Maximized:
                    if (_EnableMaximize == true)
                    {
                        G.DrawString("2", new Font("Marlett", 12), new SolidBrush(Color.FromArgb(255, 254, 255)), new Point(51, 7), new StringFormat { Alignment = StringAlignment.Center });
                    }
                    else
                    {
                        G.DrawString("2", new Font("Marlett", 12), new SolidBrush(Color.LightGray), new Point(51, 7), new StringFormat { Alignment = StringAlignment.Center });
                    }
                    break;
                case FormWindowState.Normal:
                    if (_EnableMaximize == true)
                    {
                        G.DrawString("1", new Font("Marlett", 12), new SolidBrush(Color.FromArgb(255, 254, 255)), new Point(51, 7), new StringFormat { Alignment = StringAlignment.Center });
                    }
                    else
                    {
                        G.DrawString("1", new Font("Marlett", 12), new SolidBrush(Color.LightGray), new Point(51, 7), new StringFormat { Alignment = StringAlignment.Center });
                    }
                    break;
            }

            //Minimize
            if (_EnableMinimize == true)
            {
                G.DrawString("0", new Font("Marlett", 12), new SolidBrush(Color.FromArgb(255, 254, 255)), new Point(20, 7), new StringFormat { Alignment = StringAlignment.Center });
            }
            else
            {
                G.DrawString("0", new Font("Marlett", 12), new SolidBrush(Color.LightGray), new Point(20, 7), new StringFormat { Alignment = StringAlignment.Center });
            }
        }
    }

    #endregion
    #region TabControl
    public class VelyseTabControl : TabControl
    {
        #region " Properties "
        private Color _TabSelectColor = Color.FromArgb(49, 79, 124);
        [Category("Velyse Appearance")]
        public Color TabSelectedColor
        {
            get { return _TabSelectColor; }
            set { _TabSelectColor = value; }
        }

        //private Color _TabSelectArrowColor = Color.White;
        //[Category("Velyse Appearance")]
        //public Color TabSelectArrowColor
        //{
        //    get { return _TabSelectArrowColor; }
        //    set { _TabSelectArrowColor = value; }
        //}

        private Color _TabControlSelectColor = Color.FromArgb(20, 20, 20);
        [Category("Velyse Appearance")]
        public Color TabControlBaseColor
        {
            get { return _TabControlSelectColor; }
            set { _TabControlSelectColor = value; }
        }

        private Color _TabControlSideColor = Color.FromArgb(31, 31, 31);
        [Category("Velyse Appearance")]
        public Color TabControlSideColor
        {
            get { return _TabControlSideColor; }
            set { _TabControlSideColor = value; }
        }

        private Color _TabMouseOverColor = Color.FromArgb(41, 41, 41);
        [Category("Velyse Appearance")]
        public Color TabMouseOverColor
        {
            get { return _TabMouseOverColor; }
            set { _TabMouseOverColor = value; }
        }

        private Color _SelectedForeColor = Color.White;
        [Category("Velyse Appearance")]
        public Color SelectedTextColor
        {
            get { return _SelectedForeColor; }
            set { _SelectedForeColor = value; }
        }
        private Color _unSelectedForeColor = Color.Gray;
        [Category("Velyse Appearance")]
        public Color unSelectedTextColor
        {
            get { return _unSelectedForeColor; }
            set { _unSelectedForeColor = value; }
        }



        #endregion
        private Graphics G;

        private Rectangle Rect;

        private int _OverIndex;

        //   private bool _FirstHeaderBorder;

        public bool FirstHeaderBorder
        {
            get;
            set;
        }

        private int OverIndex
        {
            get
            {
                return this._OverIndex;
            }
            set
            {
                this._OverIndex = value;
                base.Invalidate();
            }
        }

        public VelyseTabControl()
        {
            this._OverIndex = -1;
            this.DoubleBuffered = true;
            base.Alignment = TabAlignment.Left;
            base.SizeMode = TabSizeMode.Fixed;
            base.ItemSize = new Size(40, 180);
        }

        protected override void OnCreateControl()
        {
            base.OnCreateControl();
            base.SetStyle(ControlStyles.UserPaint, true);
        }

        protected override void OnControlAdded(ControlEventArgs e)
        {
            base.OnControlAdded(e);
            e.Control.BackColor = _TabControlSelectColor;
            e.Control.ForeColor = _SelectedForeColor;
            e.Control.Font = new Font("Segoe UI", 9f);
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            this.G = e.Graphics;
            this.G.SmoothingMode = SmoothingMode.HighQuality;
            this.G.TextRenderingHint = TextRenderingHint.ClearTypeGridFit;
            base.OnPaint(e);
            this.G.Clear(_TabControlSideColor);

            checked
            {
                int num = base.TabPages.Count - 1;
                for (int i = 0; i <= num; i++)
                {
                    this.Rect = base.GetTabRect(i);
                    bool flag = string.IsNullOrEmpty(Conversions.ToString(base.TabPages[i].Tag));
                    if (flag)
                    {
                        bool flag2 = base.SelectedIndex == i;
                        if (flag2)
                        {
                            using (SolidBrush solidBrush = new SolidBrush(_TabSelectColor)) //_TabSelectColor
                            {
                                using (SolidBrush solidBrush2 = new SolidBrush(_SelectedForeColor))
                                {
                                    using (Font font = new Font("Segoe UI semibold", 9f))
                                    {
                                        this.G.FillRectangle(solidBrush, new Rectangle(this.Rect.X - 5, this.Rect.Y + 1, this.Rect.Width + 7, this.Rect.Height));
                                        this.G.DrawString(base.TabPages[i].Text, font, solidBrush2, new Point(this.Rect.X + 50 + (base.ItemSize.Height - 180), this.Rect.Y + 12));
                                    }
                                }
                            }
                        }
                        else
                        {
                            using (SolidBrush solidBrush3 = new SolidBrush(_unSelectedForeColor))
                            {
                                using (Font font2 = new Font("Segoe UI semibold", 9f))
                                {
                                    this.G.DrawString(base.TabPages[i].Text, font2, solidBrush3, new Point(this.Rect.X + 50 + (base.ItemSize.Height - 180), this.Rect.Y + 12));
                                }
                            }
                        }
                        bool flag3 = this.OverIndex != -1 & base.SelectedIndex != this.OverIndex;
                        if (flag3)
                        {
                            using (SolidBrush solidBrush4 = new SolidBrush(_TabMouseOverColor))
                            {
                                using (SolidBrush solidBrush5 = new SolidBrush(_unSelectedForeColor))
                                {
                                    using (Font font3 = new Font("Segoe UI semibold", 9f))
                                    {
                                        this.G.FillRectangle(solidBrush4, new Rectangle(base.GetTabRect(this.OverIndex).X - 5, base.GetTabRect(this.OverIndex).Y + 1, base.GetTabRect(this.OverIndex).Width + 7, base.GetTabRect(this.OverIndex).Height));
                                        this.G.DrawString(base.TabPages[this.OverIndex].Text, font3, solidBrush5, new Point(base.GetTabRect(this.OverIndex).X + 50 + (base.ItemSize.Height - 180), base.GetTabRect(this.OverIndex).Y + 12));
                                    }
                                }
                            }
                            bool flag4 = !Information.IsNothing(base.ImageList);
                            if (flag4)
                            {
                                bool flag5 = base.TabPages[this.OverIndex].ImageIndex >= 0;
                                if (flag5)
                                {
                                    this.G.DrawImage(base.ImageList.Images[base.TabPages[this.OverIndex].ImageIndex], new Rectangle(base.GetTabRect(this.OverIndex).X + 25 + (base.ItemSize.Height - 180), (int)Math.Round(unchecked((double)base.GetTabRect(this.OverIndex).Y + ((double)base.GetTabRect(this.OverIndex).Height / 2.0 - 9.0))), 16, 16));
                                }
                            }
                        }
                        bool flag6 = !Information.IsNothing(base.ImageList);
                        if (flag6)
                        {
                            bool flag7 = base.TabPages[i].ImageIndex >= 0;
                            if (flag7)
                            {
                                this.G.DrawImage(base.ImageList.Images[base.TabPages[i].ImageIndex], new Rectangle(this.Rect.X + 25 + (base.ItemSize.Height - 180), (int)Math.Round(unchecked((double)this.Rect.Y + ((double)this.Rect.Height / 2.0 - 9.0))), 16, 16));
                            }
                        }
                    }
                    else
                    {
                        using (SolidBrush solidBrush6 = new SolidBrush(_TabControlSelectColor))
                        {
                            using (Font font4 = new Font("Segoe UI", 7f, FontStyle.Bold))
                            {
                                using (Pen pen = new Pen(Color.Pink))
                                {
                                    bool firstHeaderBorder = this.FirstHeaderBorder;
                                    if (firstHeaderBorder)
                                    {
                                        this.G.DrawLine(pen, new Point(this.Rect.X - 5, this.Rect.Y + 1), new Point(this.Rect.Width + 7, this.Rect.Y + 1));
                                    }
                                    else
                                    {
                                        bool flag8 = i != 0;
                                        if (flag8)
                                        {
                                            this.G.DrawLine(pen, new Point(this.Rect.X - 5, this.Rect.Y + 1), new Point(this.Rect.Width + 7, this.Rect.Y + 1));
                                        }
                                    }
                                    this.G.DrawString(base.TabPages[i].Text.ToUpper(), font4, solidBrush6, new Point(this.Rect.X + 25 + (base.ItemSize.Height - 180), this.Rect.Y + 16));
                                }
                            }
                        }
                    }
                }
            }



        }

        protected override void OnSelecting(TabControlCancelEventArgs e)
        {
            base.OnSelecting(e);
            bool flag = !Information.IsNothing(e.TabPage);
            if (flag)
            {
                bool flag2 = !string.IsNullOrEmpty(Conversions.ToString(e.TabPage.Tag));
                if (flag2)
                {
                    e.Cancel = true;
                }
                else
                {
                    this.OverIndex = -1;
                }
            }
        }

        protected override void OnMouseMove(MouseEventArgs e)
        {
            base.OnMouseMove(e);
            checked
            {
                int num = base.TabPages.Count - 1;
                for (int i = 0; i <= num; i++)
                {
                    bool flag = base.GetTabRect(i).Contains(e.Location) & base.SelectedIndex != i & string.IsNullOrEmpty(Conversions.ToString(base.TabPages[i].Tag));
                    if (flag)
                    {
                        this.OverIndex = i;
                        break;
                    }
                    this.OverIndex = -1;
                }
            }
        }

        protected override void OnMouseLeave(EventArgs e)
        {
            base.OnMouseLeave(e);
            this.OverIndex = -1;
        }
    }
    #endregion

    class VelyseProgressBar : Control
    {

        private Color _ProgressColor = Color.FromArgb(47, 156, 215);
        [Category("Velyse Appearance")]
        public Color ProgressColor
        {
            get { return _ProgressColor; }
            set
            {
                _ProgressColor = value;
                Invalidate();
            }
        }
        private Color _BackColor = Color.FromArgb(23, 26, 28);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        private Color _TextColor = Color.White;
        [Category("Velyse Appearance")]
        public Color TextColor
        {
            get { return _TextColor; }
            set { _TextColor = value; }
        }
        private Color _OutLineColor = Color.FromArgb(35, 35, 35);
        [Category("Velyse Appearance")]
        public Color OutLineColor
        {
            get { return _OutLineColor; }
            set { _OutLineColor = value; }
        }



        private int _val = 0;
        public int Value
        {
            get { return _val; }
            set
            {
                _val = value;
                ValChanged();
                Invalidate();
            }
        }

        private int _min = 0;
        public int Min
        {
            get { return _min; }
            set
            {
                _min = value;
                Invalidate();
            }
        }

        private int _max = 100;
        public int Max
        {
            get { return _max; }
            set
            {
                _max = value;
                Invalidate();
            }
        }

        private bool _showPercent = false;
        public bool ShowPercent
        {
            get { return _showPercent; }
            set
            {
                _showPercent = value;
                Invalidate();
            }
        }

        private void ValChanged()
        {
            if (_val > _max)
            {
                _val = _max;
            }
        }

        public VelyseProgressBar()
        {
            DoubleBuffered = true;
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            dynamic G = e.Graphics;
            G.TextRenderingHint = TextRenderingHint.ClearTypeGridFit;
            G.SmoothingMode = SmoothingMode.HighQuality;
            G.PixelOffsetMode = PixelOffsetMode.HighQuality;
            if (Parent.BackColor == Color.FromArgb(40, 40, 40))
            {
                G.Clear(_BackColor);
            }
            else
            {
                G.Clear(_BackColor);
            }
            int _Progress = Convert.ToInt32(_val / _max * Width);

            G.DrawRectangle(new Pen(_OutLineColor), 0, 0, Width, Height);
            G.FillRectangle(new SolidBrush(_ProgressColor), new Rectangle(0, 0, _val * (Width - 35) / (_max - _min), Height));
            G.DrawLine(new Pen(Color.FromArgb(30, Color.White)), new Point(0, 0), new Point(_Progress - 1, 0));
            G.FillRectangle(new SolidBrush(_OutLineColor), new Rectangle(0, 0, 1, 1));
            G.FillRectangle(new SolidBrush(_OutLineColor), new Rectangle(Width - 1, 0, 1, 1));
            G.DrawLine(new Pen(Color.FromArgb(70, Color.Black)), new Point(0, Height), new Point(_Progress - 1, Height));
            G.InterpolationMode = (InterpolationMode)7;
        }

    }

    public class VelyseComboBox : ComboBox
    {

        #region " Properties"
        private Color _AccentColor;
        [Category("Velyse Appearance")]
        public Color AccentColor
        {
            get { return _AccentColor; }
            set
            {
                _AccentColor = value;
                Invalidate();
            }
        }
        private Color _TextColor = Color.FromArgb(255, 255, 255);
        [Category("Velyse Appearance")]
        public Color TextColor
        {
            get { return _TextColor; }
            set
            {
                _TextColor = value;
                Invalidate();
            }
        }
        private Color _BaseColor = Color.FromArgb(20, 23, 25);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BaseColor; }
            set
            {
                _BaseColor = value;
                Invalidate();
            }
        }
        private Color _BorderColor = Color.FromArgb(20, 20, 20);
        [Category("Velyse Appearance")]
        public Color BorderColor
        {
            get { return _BorderColor; }
            set
            {
                _BorderColor = value;
                Invalidate();
            }
        }
        private Color _ArrowColor = Color.FromArgb(49, 79, 124);
        [Category("Velyse Appearance")]
        public Color ArrowColor
        {
            get { return _ArrowColor; }
            set
            {
                _ArrowColor = value;
                Invalidate();
            }
        }


        private int _StartIndex = 0;
        private int StartIndex
        {
            get { return _StartIndex; }
            set
            {
                _StartIndex = value;
                try
                {
                    base.SelectedIndex = value;
                }
                catch
                {
                }
                Invalidate();
            }
        }
        public void ReplaceItem(Object sender, DrawItemEventArgs e)
        {
            //  Dim C As ComboBox
            e.DrawBackground();
            try
            {
                if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)
                {
                    e.Graphics.FillRectangle(new SolidBrush(_AccentColor), e.Bounds);
                }
                else
                {
                    e.Graphics.FillRectangle(new SolidBrush(_BorderColor), e.Bounds);
                }
                e.Graphics.DrawString(base.GetItemText(base.Items[e.Index]), e.Font, new SolidBrush(_TextColor), e.Bounds);
            }
            catch
            {
            }
            // C.Size = New Size(Me.Width - 8, Me.Height - 40)
        }
        protected void DrawTriangle(Color Clr, Point FirstPoint, Point SecondPoint, Point ThirdPoint, Graphics G)
        {
            List<Point> points = new List<Point>();
            points.Add(FirstPoint);
            points.Add(SecondPoint);
            points.Add(ThirdPoint);
            G.FillPolygon(new SolidBrush(Clr), points.ToArray());
        }

        #endregion

        public VelyseComboBox() : base()
        {
            DrawItem += ReplaceItem;
            SetStyle(ControlStyles.AllPaintingInWmPaint, true);
            SetStyle(ControlStyles.ResizeRedraw, true);
            SetStyle(ControlStyles.UserPaint, true);
            SetStyle(ControlStyles.DoubleBuffer, true);
            SetStyle(ControlStyles.SupportsTransparentBackColor, true);
            DrawMode = DrawMode.OwnerDrawFixed;
            BackColor = _BaseColor;
            ForeColor = _TextColor;
            AccentColor = Color.FromArgb(40, 40, 40);
            DropDownStyle = ComboBoxStyle.DropDownList;
            Font = new Font("Century", 10f);
            StartIndex = 0;
            DoubleBuffered = true;
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            Bitmap B = new Bitmap(Width, Height);
            Graphics G = Graphics.FromImage(B);

            G.SmoothingMode = SmoothingMode.HighQuality;


            G.Clear(_BaseColor);
            G.DrawLine(new Pen(new SolidBrush(_ArrowColor), 3), new Point(Width - 18, 10), new Point(Width - 14, 14));
            G.DrawLine(new Pen(new SolidBrush(_ArrowColor), 3), new Point(Width - 14, 14), new Point(Width - 10, 10));
            G.DrawLine(new Pen(new SolidBrush(_ArrowColor)), new Point(Width - 14, 15), new Point(Width - 14, 14));

            G.DrawRectangle(new Pen(new SolidBrush(_BorderColor)), new Rectangle(0, 0, Width - 1, Height - 1));


            try
            {
                G.DrawString(Text, Font, new SolidBrush(_TextColor), new Rectangle(7, 0, Width - 1, Height - 1), new StringFormat
                {
                    LineAlignment = StringAlignment.Center,
                    Alignment = StringAlignment.Near
                });

            }
            catch
            {
            }

            e.Graphics.DrawImage((Image)(B.Clone()), 0, 0);

            G.Dispose();
            B.Dispose();
        }

    }
    //[DefaultEvent("CheckedChanged")]
    public class VelyseRadioButton : Control
    {
        private MouseState _State = MouseState.None;
        private int W;

        [Category("Velyse Appearance")]
        private Color _TextColor = Color.FromArgb(255, 255, 255);
        public Color TextColor
        {
            get { return _TextColor; }
            set
            {
                _TextColor = value;
                Invalidate();
            }
        }
        [Category("Velyse Appearance")]
        private Color _BackColor = Color.FromArgb(30, 33, 35);
        public Color BaseColor
        {
            get { return _BackColor; }
            set
            {
                _BackColor = value;
                Invalidate();
            }
        }
        [Category("Velyse Appearance")]
        private Color _BorderColor = Color.FromArgb(25, 25, 25);
        public Color BorderColor
        {
            get { return _BorderColor; }
            set
            {
                _BorderColor = value;
                Invalidate();
            }
        }
        [Category("Velyse Appearance")]
        private Color _CheckedColor = Color.FromArgb(35, 104, 160);
        public Color CheckedColor
        {
            get { return _CheckedColor; }
            set
            {
                _CheckedColor = value;
                Invalidate();
            }
        }

        [Category("Velyse Appearance")]
        private Color _ElipseColor = Color.FromArgb(25, 25, 25);
        public Color ElipseColor
        {
            get { return _ElipseColor; }
            set
            {
                _ElipseColor = value;
                Invalidate();
            }
        }


        private bool _Checked;
        public bool Checked
        {
            get { return _Checked; }
            set
            {
                _Checked = value;
                InvalidateControls();
                if (CheckedChanged != null)
                {
                    CheckedChanged(this);
                }
                Invalidate();
            }
        }

        public event CheckedChangedEventHandler CheckedChanged;
        public delegate void CheckedChangedEventHandler(object sender);

        protected override void OnClick(EventArgs e)
        {
            if (!_Checked)
                Checked = true;
            base.OnClick(e);
        }

        private void InvalidateControls()
        {
            if (!IsHandleCreated || !_Checked)
                return;
            foreach (Control C in Parent.Controls)
            {
                if (!object.ReferenceEquals(C, this) && C is VelyseRadioButton)
                {
                    ((VelyseRadioButton)C).Checked = false;
                    Invalidate();
                }
            }
        }
        protected override void OnResize(EventArgs e)
        {
            base.OnResize(e);
            Height = 22;
        }

        protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            _State = MouseState.Down;
            Invalidate();
        }

        protected override void OnMouseUp(MouseEventArgs e)
        {
            base.OnMouseUp(e);
            _State = MouseState.Over;
            Invalidate();
        }

        protected override void OnMouseEnter(EventArgs e)
        {
            base.OnMouseEnter(e);
            _State = MouseState.Over;
            Invalidate();
        }

        protected override void OnMouseLeave(EventArgs e)
        {
            base.OnMouseLeave(e);
            _State = MouseState.None;
            Invalidate();
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            var G = e.Graphics;
            G.SmoothingMode = SmoothingMode.AntiAlias;
            G.Clear(_BackColor);
            if (Parent.BackColor == _BackColor)
                G.FillEllipse(new SolidBrush(_ElipseColor), new Rectangle(0, 0, 13, 13));
            else
                G.FillEllipse(new SolidBrush(_ElipseColor), new Rectangle(0, 0, 13, 13));
            G.DrawEllipse(new Pen(_BorderColor), new Rectangle(0, 0, 13, 13));
            if (Checked)
                G.FillEllipse(new SolidBrush(_CheckedColor), new Rectangle(3, 3, 7, 7));
            G.DrawString(Text, new Font("Arial", 9), new SolidBrush(_TextColor), new Point(18, 0));
        }
    }
    public class VelyseCheckbox : Control
    {
        private MouseState _State = MouseState.None;
        private int W;

        [Category("Velyse Appearance")]
        private Color _TextColor = Color.FromArgb(255, 255, 255);
        public Color TextColor
        {
            get { return _TextColor; }
            set
            {
                _TextColor = value;
                Invalidate();
            }
        }
        [Category("Velyse Appearance")]
        private Color _BackColor = Color.FromArgb(30, 33, 35);
        public Color BaseColor
        {
            get { return _BackColor; }
            set
            {
                _BackColor = value;
                Invalidate();
            }
        }
        [Category("Velyse Appearance")]
        private Color _BorderColor = Color.FromArgb(25, 25, 25);
        public Color BorderColor
        {
            get { return _BorderColor; }
            set
            {
                _BorderColor = value;
                Invalidate();
            }
        }
        [Category("Velyse Appearance")]
        private Color _CheckedColor = Color.FromArgb(35, 104, 160);
        public Color CheckedColor
        {
            get { return _CheckedColor; }
            set
            {
                _CheckedColor = value;
                Invalidate();
            }
        }

        [Category("Velyse Appearance")]
        private Color _ElipseColor = Color.FromArgb(25, 25, 25);
        public Color ElipseColor
        {
            get { return _ElipseColor; }
            set
            {
                _ElipseColor = value;
                Invalidate();
            }
        }


        private bool _Checked;
        public bool Checked
        {
            get { return _Checked; }
            set
            {
                _Checked = value;
                InvalidateControls();
                if (CheckedChanged != null)
                {
                    CheckedChanged(this);
                }
                Invalidate();
            }
        }

        public event CheckedChangedEventHandler CheckedChanged;
        public delegate void CheckedChangedEventHandler(object sender);

        protected override void OnClick(EventArgs e)
        {
            if (!_Checked)
                Checked = true;
            else
                Checked = false;
            base.OnClick(e);
        }

        private void InvalidateControls()
        {
            if (!IsHandleCreated || !_Checked)
                return;
            foreach (Control C in Parent.Controls)
            {
                if (!object.ReferenceEquals(C, this) && C is VelyseCheckbox)
                {
                    // ((VelyseCheckbox)C).Checked = false;
                    Invalidate();
                }
            }
        }
        protected override void OnResize(EventArgs e)
        {
            base.OnResize(e);
            Height = 22;
        }

        protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            _State = MouseState.Down;
            Invalidate();
        }

        protected override void OnMouseUp(MouseEventArgs e)
        {
            base.OnMouseUp(e);
            _State = MouseState.Over;
            Invalidate();
        }

        protected override void OnMouseEnter(EventArgs e)
        {
            base.OnMouseEnter(e);
            _State = MouseState.Over;
            Invalidate();
        }

        protected override void OnMouseLeave(EventArgs e)
        {
            base.OnMouseLeave(e);
            _State = MouseState.None;
            Invalidate();
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            var G = e.Graphics;
            G.SmoothingMode = SmoothingMode.AntiAlias;
            G.Clear(_BackColor);
            if (Parent.BackColor == _BackColor)
                G.FillRectangle(new SolidBrush(_ElipseColor), new Rectangle(0, 0, 13, 13));
            else
                G.FillRectangle(new SolidBrush(_ElipseColor), new Rectangle(0, 0, 13, 13));
            G.DrawRectangle(new Pen(_BorderColor), new Rectangle(0, 0, 13, 13));
            if (Checked)
                G.FillRectangle(new SolidBrush(_CheckedColor), new Rectangle(3, 3, 7, 7));
            G.DrawString(Text, new Font("Arial", 9), new SolidBrush(_TextColor), new Point(18, 0));
        }
    }
    public class VelyseCircularProgressBar : Control
    {

        #region Enums

        public enum _ProgressShape
        {
            Round,
            Flat
        }

        #endregion

        #region Variables

        private long _Value;
        private long _Maximum = 100;
        private _ProgressShape ProgressShapeVal;

        #endregion

        #region Custom Properties

        private Color _ProgressColor = Color.FromArgb(47, 156, 215);
        [Category("Velyse Appearance")]
        public Color ProgressColor
        {
            get { return _ProgressColor; }
            set
            {
                _ProgressColor = value;
                Invalidate();
            }
        }
        private Color _ProgressColo2r = Color.FromArgb(47, 156, 215);
        [Category("Velyse Appearance")]
        public Color ProgressColor2
        {
            get { return _ProgressColo2r; }
            set
            {
                _ProgressColo2r = value;
                Invalidate();
            }
        }
        private Color _BackColor = Color.FromArgb(30, 33, 35);
        [Category("Velyse Appearance")]
        public Color BaseColor
        {
            get { return _BackColor; }
            set { _BackColor = value; }
        }
        private Color _TextColor = Color.White;
        [Category("Velyse Appearance")]
        public Color TextColor
        {
            get { return _TextColor; }
            set { _TextColor = value; }
        }
        private Color _OutLineColor = Color.FromArgb(35, 35, 35);
        [Category("Velyse Appearance")]
        public Color OutLineColor
        {
            get { return _OutLineColor; }
            set { _OutLineColor = value; }
        }

        public long Value
        {
            get { return _Value; }
            set
            {
                if (value > _Maximum)
                    value = _Maximum;
                _Value = value;
                Invalidate();
            }
        }

        public long Maximum
        {
            get { return _Maximum; }
            set
            {
                if (value < 1)
                    value = 1;
                _Maximum = value;
                Invalidate();
            }
        }

        public _ProgressShape ProgressShape
        {
            get { return ProgressShapeVal; }
            set
            {
                ProgressShapeVal = value;
                Invalidate();
            }
        }

        #endregion

        #region EventArgs

        protected override void OnResize(EventArgs e)
        {
            base.OnResize(e);
            SetStandardSize();
        }

        protected override void OnSizeChanged(EventArgs e)
        {
            base.OnSizeChanged(e);
            SetStandardSize();
        }

        protected override void OnPaintBackground(PaintEventArgs p)
        {
            base.OnPaintBackground(p);
        }

        #endregion

        #region Methods
        public VelyseCircularProgressBar()
        {
            Size = new Size(130, 130);
            Font = new Font("Segoe UI", 15);
            MinimumSize = new Size(100, 100);
            DoubleBuffered = true;
            Value = 57;
            ProgressShape = _ProgressShape.Flat;
            this.ForeColor = _TextColor;
            this.BackColor = _BackColor;
        }

        private void SetStandardSize()
        {
            int _Size = Math.Max(Width, Height);
            Size = new Size(_Size, _Size);
        }

        public void Increment(int Val)
        {
            this._Value += Val;
            Invalidate();
        }

        public void Decrement(int Val)
        {
            this._Value -= Val;
            Invalidate();
        }
        #endregion

        #region Events
        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            using (Bitmap bitmap = new Bitmap(this.Width, this.Height))
            {
                using (Graphics graphics = Graphics.FromImage(bitmap))
                {
                    graphics.SmoothingMode = SmoothingMode.AntiAlias;
                    graphics.Clear(_BackColor);


                    using (Pen pen2 = new Pen(_OutLineColor))
                    {
                        graphics.DrawEllipse(pen2, 0x18 - 6, 0x18 - 6, (this.Width - 0x30) + 12, (this.Height - 0x30) + 12);
                    }


                    using (LinearGradientBrush brush = new LinearGradientBrush(this.ClientRectangle, this._ProgressColor, this._ProgressColo2r, LinearGradientMode.ForwardDiagonal))
                    {
                        using (Pen pen = new Pen(brush, 14f))
                        {
                            switch (this.ProgressShapeVal)
                            {
                                case _ProgressShape.Round:
                                    pen.StartCap = LineCap.Round;
                                    pen.EndCap = LineCap.Round;
                                    break;

                                case _ProgressShape.Flat:
                                    pen.StartCap = LineCap.Flat;
                                    pen.EndCap = LineCap.Flat;
                                    break;
                            }

                            graphics.DrawArc(pen, 0x12, 0x12, (this.Width - 0x23) - 2, (this.Height - 0x23) - 2, -90, (int)Math.Round((double)((360.0 / ((double)this._Maximum)) * this._Value)));
                        }
                    }


                    Brush FontColor = new SolidBrush(_TextColor);
                    SizeF MS = graphics.MeasureString(Convert.ToString(Convert.ToInt32((100 / _Maximum) * _Value)), Font);
                    graphics.DrawString(Convert.ToString(Convert.ToInt32((100 / _Maximum) * _Value)), Font, new SolidBrush(_TextColor), Convert.ToInt32(Width / 2 - MS.Width / 2), Convert.ToInt32(Height / 2 - MS.Height / 2));
                    e.Graphics.DrawImage(bitmap, 0, 0);
                    graphics.Dispose();
                    bitmap.Dispose();
                }
            }
        }
        #endregion
    }



    public class VelyseNumeric : Control
    {


        private int W, H;
        private MouseState State = MouseState.None;
        private int x, y;
        private long _Value, _Min, _Max;
        private bool Bool;
        public enum _ThemeChoose
        {
            Light,
            Dark,
            Custom
        }




        public long Value
        {
            get
            {
                return _Value;
            }
            set
            {
                if (value <= _Max & value >= _Min)
                    _Value = value;
                Invalidate();
            }
        }

        public long Maximum
        {
            get
            {
                return _Max;
            }
            set
            {
                if (value > _Min)
                    _Max = value;
                if (_Value > _Max)
                    _Value = _Max;
                Invalidate();
            }
        }

        public long Minimum
        {
            get
            {
                return _Min;
            }
            set
            {
                if (value < _Max)
                    _Min = value;
                if (_Value < _Min)
                    _Value = Minimum;
                Invalidate();
            }
        }

        protected override void OnMouseMove(MouseEventArgs e)
        {
            base.OnMouseMove(e);
            x = e.Location.X;
            y = e.Location.Y;
            Invalidate();
            if (e.X < Width - 23)
                Cursor = Cursors.IBeam;
            else
                Cursor = Cursors.Hand;
        }

        protected override void OnMouseDown(MouseEventArgs e)
        {
            base.OnMouseDown(e);
            if (x > Width - 21 && x < Width - 3)
            {
                if (y < 15)
                {
                    if ((Value + 1) <= _Max)
                        _Value += 1;
                }
                else if ((Value - 1) >= _Min)
                    _Value -= 1;
            }
            else
            {
                Bool = !Bool;
                Focus();
            }
            Invalidate();
        }

        protected override void OnKeyPress(KeyPressEventArgs e)
        {
            base.OnKeyPress(e);
            try
            {
                if (Bool)
                    _Value = Convert.ToInt64(Convert.ToString(_Value) + e.KeyChar.ToString());
                if (_Value > _Max)
                    _Value = _Max;
                Invalidate();
            }
            catch
            {
            }
        }

        protected override void OnKeyDown(KeyEventArgs e)
        {
            base.OnKeyDown(e);
            if (e.KeyCode == Keys.Back)
                Value = 0;
        }

        protected override void OnResize(EventArgs e)
        {
            base.OnResize(e);
            Height = 30;
        }


        [Category("Velyse Appearance")]
        private Color _BackColor = Color.FromArgb(45, 47, 49);
        public Color BaseColor
        {
            get
            {
                return _BackColor;
            }
            set
            {
                _BackColor = value;
            }
        }

        [Category("Velyse Appearance")]
        private Color _ButtonColor = Color.FromArgb(49, 79, 124);
        public Color ButtonColor
        {
            get
            {
                return _ButtonColor;
            }
            set
            {
                _ButtonColor = value;
            }
        }
        [Category("Velyse Appearance")]
        private Color _AddSubTextColor = Color.Gray;
        public Color AddSubTextColor
        {
            get
            {
                return _AddSubTextColor;
            }
            set
            {
                _AddSubTextColor = value;
            }
        }
        [Category("Velyse Appearance")]
        private Color _ValTextColor = Color.FromArgb(150, 150, 150);
        public Color ValueTextColor
        {
            get
            {
                return _ValTextColor;
            }
            set
            {
                _ValTextColor = value;
            }
        }

        [Category("Velyse Appearance")]
        private _ThemeChoose myTheme;
        public _ThemeChoose _Theme
        {
            get
            {
                return myTheme;
            }
            set
            {
                myTheme = value;
            }
        }



        public VelyseNumeric()
        {
            SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint | ControlStyles.ResizeRedraw | ControlStyles.OptimizedDoubleBuffer | ControlStyles.SupportsTransparentBackColor, true);
            DoubleBuffered = true;
            Font = new Font("Segoe UI", 10);
            BackColor = _BackColor;
            ForeColor = _AddSubTextColor;
            _Min = 0;
            _Max = 9999999;
        }


        protected override void OnPaint(PaintEventArgs e)
        {



            var B = new Bitmap(Width, Height);
            var G = Graphics.FromImage(B);

            W = Width; H = Height;

            Rectangle Base = new Rectangle(0, 0, W, H);

            {
                var withBlock = G;
                withBlock.SmoothingMode = SmoothingMode.HighQuality;
                withBlock.PixelOffsetMode = PixelOffsetMode.HighQuality;
                withBlock.TextRenderingHint = TextRenderingHint.ClearTypeGridFit;
                withBlock.Clear(BackColor);

                // -- Base
                withBlock.FillRectangle(new SolidBrush(_BackColor), Base);
                withBlock.FillRectangle(new SolidBrush(_ButtonColor), new Rectangle(Width - 24, 0, 24, H));

                // -- Add
                withBlock.DrawString("+", new Font("Segoe UI", 10), new SolidBrush(_AddSubTextColor), new Point(Width - 19, 0));
                // -- Subtract
                withBlock.DrawString("-", new Font("Segoe UI", 10, FontStyle.Bold), new SolidBrush(_AddSubTextColor), new Point(Width - 17, 12));

                // -- Text
                Color ColorColor = Color.FromArgb(150, 150, 150);
                withBlock.DrawString(Convert.ToString(_Value), Font, new SolidBrush(_ValTextColor), new Rectangle(5, 1, W, H), new StringFormat() { LineAlignment = StringAlignment.Center });
            }

            base.OnPaint(e);
            G.Dispose();
            e.Graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
            e.Graphics.DrawImageUnscaled(B, 0, 0);
            B.Dispose();
        }

    }

}

